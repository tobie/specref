var TR_URL = /https?:\/\/www\.w3\.org\/TR\//;

var SPECIAL_CASES = {
    'https://www.w3.org/Search/9605-Indexing-Workshop/ReportOutcomes/S6Group2': "S6Group2",
    'https://www.w3.org/TR/1998/NOTE-P3P10-Protocols': "P3P10-Protocols",
    'https://www.w3.org/1999/05/WCA-terms/': "WCA-terms",
    'https://www.w3.org/TR/1998/WD-HTTP-NG-goals': "HTTP-NG-goals",
    'https://www.w3.org/TR/REC-html32': "HTML32",
    'https://www.w3.org/TR/2001/WD-xhtml1-20011004/': 'xhtml1'
};

var SHORT_NAME_SPECIAL_CASES = {
    "html": "w3c-html",
    "NOTE-CSS-potential": "CSS-potential",
    "NOTE-P3P10-principles": "P3P10-principles",
    "NOTE-SYMM-modules": "SYMM-modules",
    "NOTE-XML-FRAG-REQ": "XML-FRAG-REQ",
    "NOTE-html-lan": "html-lan",
    "NOTE-voice": "voice",
    "NOTE-xh": "xh",
    "NOTE-xlink-principles": "xlink-principles",
    "NOTE-xml-canonical-req": "xml-canonical-req",
    "NOTE-xml-infoset-req": "xml-infoset-req",
    "NOTE-xml-schema-req": "xml-schema-req",
    "NOTE-xptr-infoset-liaison": "xptr-infoset-liaison",
    "NOTE-xptr-req": "xptr-req",
    "NOTE-HTTP-NG-testbed": "HTTP-NG-testbed",
    "NOTE-WCA": "WCA",
    "NOTE-html40-mobile": "html40-mobile",
    "NOTE-rdf-uml": "rdf-uml",
    "NOTE-xlink-req": "xlink-req",
    "WD-DSIG-label-arch": "DSIG-label-arch",
    "WD-HTTP-NG-architecture": "HTTP-NG-architecture",
    "WD-HTTP-NG-interfaces": "HTTP-NG-interfaces",
    "WD-HTTP-NG-wire": "HTTP-NG-wire",
    "WD-P3P-arch": "P3P-arch",
    "WD-P3P-grammar": "P3P-grammar",
    "WD-SVGReq": "SVGReq",
    "WD-XSLReq": "XSLReq",
    "WD-acss": "acss",
    "WD-font": "font",
    "WD-http-pep": "http-pep",
    "WD-ilu-requestor": "ilu-requestor",
    "WD-jepi-uppflow": "jepi-uppflow",
    "WD-mux": "mux",
    "WD-positioning": "positioning",
    "WD-print": "print",
    "NOTE-agent-attributes": "agent-attributes",
    "NOTE-amaya": "amaya",
    "NOTE-AS": "AS",
    "NOTE-authentform": "authentform",
    "NOTE-CCPPexchange": "CCPPexchange",
    "NOTE-CSS-smil": "CSS-smil",
    "NOTE-datetime": "datetime",
    "NOTE-dcd": "dcd",
    "NOTE-ddml": "ddml",
    "NOTE-drawml": "drawml",
    "NOTE-drp": "drp",
    "NOTE-eu-conf": "eu-conf",
    "NOTE-expamaya": "expamaya",
    "NOTE-framework-970706": "framework-970706",
    "NOTE-gdiff": "gdiff",
    "NOTE-HGML": "HGML",
    "NOTE-html": "html",
    "NOTE-HTMLComponents": "HTMLComponents",
    "NOTE-HTMLplusTIME": "HTMLplusTIME",
    "NOTE-http-edit-dist-scenarios": "http-edit-dist-scenarios",
    "NOTE-ice": "ice",
    "NOTE-IPWG-Practices": "IPWG-Practices",
    "NOTE-jepi": "jepi",
    "NOTE-link": "link",
    "NOTE-MCF-XML": "MCF-XML",
    "NOTE-P3P-CACM": "P3P-CACM",
    "NOTE-PICS-Cookie-extension": "PICS-Cookie-extension",
    "NOTE-pics-ng-metadata": "pics-ng-metadata",
    "NOTE-PICS-Statement": "PICS-Statement",
    "NOTE-PIDL": "PIDL",
    "NOTE-rdf-simple-intro": "rdf-simple-intro",
    "NOTE-rdfarch": "rdfarch",
    "NOTE-SDML": "SDML",
    "NOTE-SOX": "SOX",
    "NOTE-stts2": "stts2",
    "NOTE-STTS3": "STTS3",
    "NOTE-TPRC-970930": "TPRC-970930",
    "NOTE-uclp": "uclp",
    "NOTE-VML": "VML",
    "NOTE-WAP": "WAP",
    "NOTE-webarch-extlang": "webarch-extlang",
    "NOTE-widl": "widl",
    "NOTE-XFDL": "XFDL",
    "NOTE-xml-ql": "xml-ql",
    "NOTE-XSL": "XSL",
    "NOTE-XSL-and-CSS": "XSL-and-CSS",
    "REC-CSS1": "CSS1",
    "REC-DOM-Level-1": "DOM-Level-1",
    "REC-DSig-label": "DSig-label",
    "REC-MathML": "MathML",
    "REC-PICS-labels": "PICS-labels",
    "REC-PICS-services": "PICS-services",
    "REC-PICSRules": "PICSRules",
    "REC-rdf-syntax": "rdf-syntax-grammar",
    "REC-smil": "smil",
    "REC-WebCGM": "WebCGM",
    "WD-logfile": "logfile",
    "WD-mptp": "mptp",
    "WD-proxy": "proxy",
    "WD-rdf-syntax": "rdf-syntax-grammar",
    "WD-session-id": "session-id",
    "WD-sgml-lex": "sgml-lex",
    "WD-wwwicn": "wwwicn"
}

function getShortName(url) {
    if (SPECIAL_CASES[url]) return SPECIAL_CASES[url];
    var parts = url.replace(TR_URL, "").split("/").filter(function(p) { return p != "/" && p != ''; });
    if (parts.length > 1) throw new Error("Can't identify shortName from url " + url);
    var part = parts[0]
    return SHORT_NAME_SPECIAL_CASES[part] || part;
}

module.exports = getShortName;